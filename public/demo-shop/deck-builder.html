<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Deck Builder | Card Vault Demo</title>
  
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@600;700;900&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'primary': '#00ff9d',
            'secondary': '#2a9d8f',
            'dark-bg': '#0a0a1f',
            'card-bg': '#1a1a2e',
            'border': '#2d2d44',
            'accent': '#e63946'
          },
          fontFamily: {
            'display': ['Cinzel', 'serif'],
            'body': ['Inter', 'system-ui', 'sans-serif']
          }
        }
      }
    }
  </script>
  
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background: #0a0a1f;
      color: #ffffff;
    }
    
    .glow-green {
      box-shadow: 0 0 20px rgba(0, 255, 157, 0.3);
    }
    
    .glow-green-hover:hover {
      box-shadow: 0 0 30px rgba(0, 255, 157, 0.5);
    }

    /* Iframe styling to match theme */
    #deck-builder-frame {
      width: 100%;
      border: 2px solid #2d2d44;
      border-radius: 1rem;
      background: #1a1a2e;
      min-height: 900px;
      box-shadow: 0 0 20px rgba(0, 255, 157, 0.1);
    }
  </style>
</head>
<body>
  
  <!-- Navbar -->
  <nav class="bg-card-bg border-b-2 border-primary shadow-lg sticky top-0 z-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between items-center h-20">
        
        <!-- Logo -->
        <a href="index.html" class="flex items-center gap-3 hover:opacity-80 transition">
          <div class="text-4xl">üÉè</div>
          <div>
            <div class="font-display text-2xl font-bold text-primary">CARD VAULT</div>
            <div class="text-xs text-gray-400 -mt-1">Demo Testing Store</div>
          </div>
        </a>
        
        <!-- Nav Links -->
        <div class="hidden md:flex items-center gap-8">
          <a href="index.html" class="text-white hover:text-primary transition font-medium">Home</a>
          <a href="index.html#features" class="text-white hover:text-primary transition font-medium">Features</a>
          <a href="deck-builder.html" class="text-primary font-bold">Deck Builder</a>
          <a href="cart.html" class="relative text-white hover:text-primary transition font-medium">
            Cart
            <span id="nav-cart-badge" class="absolute -top-2 -right-6 bg-accent text-white text-xs font-bold px-2 py-1 rounded-full">0</span>
          </a>
        </div>
        
        <!-- Mobile Menu Button -->
        <button class="md:hidden text-white">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
        </button>
        
      </div>
    </div>
  </nav>
  
  <!-- Page Header -->
  <section class="bg-gradient-to-r from-primary/10 to-secondary/10 py-16">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <h1 class="font-display text-5xl font-bold text-center mb-4">
        <span class="text-primary">‚ö° Deck Builder</span>
      </h1>
      <p class="text-center text-gray-300 text-lg">
        Paste your deck list and instantly find all cards in our inventory
      </p>
    </div>
  </section>
  
  <!-- Deck Builder Content -->
  <section class="py-12 min-h-screen">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      
      <!-- Instructions Card -->
      <div class="bg-card-bg border border-primary/30 rounded-2xl p-6 mb-8 glow-green">
        <div class="flex items-start gap-4">
          <div class="text-3xl">üí°</div>
          <div>
            <h2 class="font-bold text-xl mb-2 text-primary">How to use:</h2>
            <ol class="text-gray-300 space-y-2">
              <li><strong>1.</strong> Paste your deck list below (e.g., "3x Blue-Eyes White Dragon")</li>
              <li><strong>2.</strong> Click "Search Cards" to find them in our inventory</li>
              <li><strong>3.</strong> Select your preferred version and condition</li>
              <li><strong>4.</strong> Add all cards to cart with one click!</li>
            </ol>
          </div>
        </div>
      </div>
      
      <!-- Embedded Deck Builder -->
      <div class="bg-card-bg border border-border rounded-2xl p-4">
        <iframe 
          id="deck-builder-frame"
          src="https://deck-mage.netlify.app/?shop=deckmage-test.myshopify.com"
          title="DeckMage Deck Builder Tool">
        </iframe>
      </div>
      
      <!-- Features Below -->
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-8">
        
        <div class="bg-card-bg border border-border rounded-xl p-6 text-center">
          <div class="text-4xl mb-3">üîç</div>
          <h3 class="font-bold text-lg mb-2 text-primary">Smart Search</h3>
          <p class="text-sm text-gray-400">
            Automatically finds cards by name, even with variations
          </p>
        </div>
        
        <div class="bg-card-bg border border-border rounded-xl p-6 text-center">
          <div class="text-4xl mb-3">üí∞</div>
          <h3 class="font-bold text-lg mb-2 text-primary">Best Prices</h3>
          <p class="text-sm text-gray-400">
            Auto-selects cheapest available version
          </p>
        </div>
        
        <div class="bg-card-bg border border-border rounded-xl p-6 text-center">
          <div class="text-4xl mb-3">‚ö°</div>
          <h3 class="font-bold text-lg mb-2 text-primary">One-Click Add</h3>
          <p class="text-sm text-gray-400">
            Add entire deck to cart instantly
          </p>
        </div>
        
      </div>
      
    </div>
  </section>
  
  <!-- Footer -->
  <footer class="bg-card-bg border-t border-border py-12">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
      <div class="flex items-center justify-center gap-2 mb-4">
        <div class="text-3xl">üÉè</div>
        <div class="font-display text-xl font-bold text-primary">CARD VAULT</div>
      </div>
      <p class="text-gray-400 text-sm mb-2">
        Demo testing store for DeckMage integration
      </p>
      <p class="text-gray-500 text-xs">
        ¬© 2025 DeckMage ‚Ä¢ Not a real store ‚Ä¢ Testing purposes only
      </p>
    </div>
  </footer>
  
 <script>
  // Update cart badge count
  function updateCartCount() {
    const cart = JSON.parse(localStorage.getItem('demoCart') || '[]')
    const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0)
    document.getElementById('nav-cart-badge').textContent = totalItems
  }
  
  // Load cart count on page load
  updateCartCount()
  
  // Listen for cart updates from other tabs/windows
  window.addEventListener('storage', updateCartCount)
  
  // Listen for messages from the deck builder iframe
  window.addEventListener('message', (event) => {
    console.log('üì® Received message:', event.data)
    
    // Check if message is from deck builder
    if (event.data.type === 'DECKMAGE_ADD_TO_CART') {
      const cart = JSON.parse(localStorage.getItem('demoCart') || '[]')
      
      console.log('üõí Current cart:', cart)
      console.log('‚ûï Adding items:', event.data.items)
      
      // Add items from deck builder
      event.data.items.forEach(item => {
        const existingIndex = cart.findIndex(c => 
          c.name === item.name && 
          c.setCode === item.setCode
        )
        
        if (existingIndex >= 0) {
          // Item already exists - increase quantity
          cart[existingIndex].quantity += item.quantity
          console.log(`üì¶ Updated ${item.name} quantity to ${cart[existingIndex].quantity}`)
        } else {
          // New item - add to cart
          cart.push(item)
          console.log(`‚úÖ Added ${item.name} to cart`)
        }
      })
      
      // Save updated cart
      localStorage.setItem('demoCart', JSON.stringify(cart))
      console.log('üíæ Saved cart:', cart)
      
      // Update badge
      updateCartCount()
      
      // Show success notification
      const notification = document.createElement('div')
      notification.style.cssText = `
        position: fixed;
        top: 100px;
        right: 20px;
        background: linear-gradient(135deg, #00ff9d, #2a9d8f);
        color: #0a0a1f;
        padding: 20px 30px;
        border-radius: 12px;
        font-weight: bold;
        box-shadow: 0 8px 32px rgba(0, 255, 157, 0.3);
        z-index: 10000;
        animation: slideIn 0.3s ease;
      `
      notification.innerHTML = `
        ‚úÖ Added ${event.data.items.length} cards to cart!
        <br>
        <small style="font-weight: normal; opacity: 0.9;">Total: $${event.data.total.toFixed(2)}</small>
      `
      
      document.body.appendChild(notification)
      
      // Remove notification after 3 seconds
      setTimeout(() => {
        notification.style.animation = 'slideOut 0.3s ease'
        setTimeout(() => notification.remove(), 300)
      }, 3000)
    }
    
    // Handle iframe resize messages
    if (event.data.type === 'deckmage-resize') {
      const iframe = document.getElementById('deck-builder-frame')
      if (iframe) {
        iframe.style.height = event.data.height + 'px'
        console.log('üìè Resized iframe to', event.data.height + 'px')
      }
    }
  })
  
  // Add CSS animations
  const style = document.createElement('style')
  style.textContent = `
    @keyframes slideIn {
      from {
        transform: translateX(400px);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }
    
    @keyframes slideOut {
      from {
        transform: translateX(0);
        opacity: 1;
      }
      to {
        transform: translateX(400px);
        opacity: 0;
      }
    }
  `
  document.head.appendChild(style)
</script>
  
</body>
</html>